把示例使用表更改StormEvents表,正好也习惯下Kusto的语法<BR>
[SQL to Kusto cheat sheet](https://docs.microsoft.com/zh-cn/azure/data-explorer/kusto/query/sqlcheatsheet)<BR>
<BR>


| SQL       | Category             | SQL Query                                                                          | Kusto Query                                                                                                                                                                                                             | Memo                                                                                                                                                              |
| --------- | -------------------- | ---------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| FROM      | 从表中选择数据       | SELECT * FROM StormEvents                                                          | StormEvents                                                                                                                                                                                                             | 就直接写表名就可以了                                                                                                                                              |
| FROM      | --                   | SELECT State FROM StormEvents                                                      | StormEvents <BR>\| project State                                                                                                                                                                                            | 单独选个列出来,project 关键字                                                                                                                                     |
| WHERE     | Null 评估            | SELECT * FROM StormEvents WHERE State IS NOT NULL                                  | StormEvents <BR>\| project  EndLocation <BR>\| where isnotnull(EndLocation)                                                                                                                                                     | 这个示例文件里没有NULL列，意思到就可以了                                                                                                                          |
| WHERE     | 比较运算符（日期）   | SELECT * FROM StormEvents WHERE timestamp > getdate()-1                            | StormEvents <BR>\| where StartTime > ago(1d)                                                                                                                                                                                | 选取相对时间,ago 最大到天,跨度看这里[The timespan data type](https://docs.microsoft.com/zh-cn/azure/data-explorer/kusto/query/scalar-data-types/timespan)                                   |
| WHERE     | --                   | SELECT * FROM StormEvents WHERE timestamp BETWEEN ... AND …                        | StormEvents <BR>\| where StartTime between(datetime(2007-01-01) .. datetime(2007-01-01))                                                                                                                                    | 选取确定时间区间,有智能提示输入速度还可以                                                                                                                         |
| WHERE     | 比较运算符（字符串） |                                                                                    | StormEvents <BR>\| where State == "NEW YORK"                                                                                                                                                                                | 严格相等[== (equals) operator](https://docs.microsoft.com/zh-cn/azure/data-explorer/kusto/query/equals-cs-operator)                                                                       |
| WHERE     | --                   |                                                                                    | StormEvents <BR>\| where State contains "YO"                                                                                                                                                                                | 包含相等[== (equals) operator](https://docs.microsoft.com/zh-cn/azure/data-explorer/kusto/query/contains-operator)                                                                        |
| WHERE     | --                   |                                                                                    | StormEvents <BR>\| where State startswith "New"                                                                                                                                                                             | 起始于                                                                                                                                                            |
| WHERE     | 比较（布尔值）       |                                                                                    |                                                                                                                                                                                                                         | 这个先略过，表里没有布尔类型，而且我竟然也不知道SQL布尔运算是这样写的。。。                                                                                       |
| GROUP BY  | 分组，聚合           | SELECT AVG(DamageProperty) FROM StormEvents GROUP BY EpisodeId                     | StormEvents <BR>\| summarize avg(DamageProperty) by EpisodeId                                                                                                                                                               | 分组大概率都是需要聚合运算，一行就搞定                                                                                                                            |
|           | 列别名、扩展         | SELECT AVG(DamageProperty) as AVG FROM StormEvents GROUP BY EpisodeId              | StormEvents <BR>\| summarize AVG = avg(DamageProperty) by EpisodeId                                                                                                                                                         | 接上取别名，需要结果导向的思维方式                                                                                                                                |
| GROUP BY  | Distinct             | SELECT DamageProperty,EpisodeId FROM StormEvents GROUP BY DamageProperty,EpisodeId | StormEvents <BR>\| summarize by DamageProperty,EpisodeId                                                                                                                                                                    | 没有聚合函数就是唯一值,其实主要是SQL混乱即可使用distinct又可使用Group by实现                                                                                      |
| HAVING    | HAVING               |                                                                                    | StormEvents <BR>\| summarize AVG = avg(DamageProperty) by EpisodeId <BR>\| where AVG > 0                                                                                                                                        | 以前SQL-92某些数据库可以把Having当Where用,现在就少个关键字挺好                                                                                                    |
| ORDER BY  | 排序                 | SELECT EpisodeId, DamageProperty ORDER BY order by EpisodeId asc                   | StormEvents <BR>\| project EpisodeId, DamageProperty <BR>\| order by EpisodeId asc nulls last                                                                                                                                   | 可以将NULL值单独排序                                                                                                                                              |
| ORDER BY  | --                   |                                                                                    | StormEvents <BR>\| summarize Count = count() by EpisodeId <BR>\| top 10 by Count desc                                                                                                                                           | SQL Top函数不能作用于函数列，需要使用子查询才能实现                                                                                                               |
| UNION ALL | UNION ALL            |                                                                                    | let View_1 = StormEvents <BR>\| where StartTime between(datetime(2007-01-01) .. datetime(2007-01-01));let View_2 = StormEvents <BR>\| where StartTime between(datetime(2007-01-01) .. datetime(2007-01-01));union View_1,View_2 | 对应SQL 的UNION ALL,去重使用单独去重方式,Let 为单独子查询.[union operator](https://docs.microsoft.com/zh-cn/azure/data-explorer/kusto/query/unionoperator?pivots=azuredataexplorer) |
| Join      | Join                 |                                                                                    |                                                                                                                                                                                                                         | 等找到有示例了再做                                                                                                                                                |
| SELECT    | 子查询               |                                                                                    |                                                                                                                                                                                                                         | 等找到有示例了再做                                                                                                                                                |

